<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An Engineer's Dive into the Underwater World</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Define a CSS variable for the viewport height unit */
            --vh: 1vh;
        }
        body {
            font-family: 'Inter', sans-serif;
            /* Prevent scrolling on the body itself */
            overflow: hidden;
        }
        .slide {
            transition: opacity 0.5s ease-in-out;
            background-size: cover;
            background-position: center;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #38bdf8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* The container now uses the JS-calculated height variable */
        #presentation-container {
             height: calc(var(--vh, 1vh) * 100);
        }
        .explain-btn {
            background-color: rgba(0, 191, 255, 0.2);
            border: 1px solid #00bfff;
            color: #00bfff;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .explain-btn:hover {
            background-color: rgba(0, 191, 255, 0.4);
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center">

    <!-- Main container now uses screen width/height for full compatibility -->
    <div id="presentation-container" class="w-screen bg-gray-800 flex flex-col overflow-hidden">
        
        <!-- Slides wrapper with responsive padding. flex-grow ensures it takes up available space -->
        <div id="slides-wrapper" class="flex-grow flex items-center justify-center p-4 sm:p-6 md:p-8 overflow-y-auto min-h-0">
            <!-- Slide 1 -->
            <div class="slide w-full h-full flex flex-col justify-center items-center text-center relative">
                <!-- Iframe as background -->
                <iframe src="https://drive.google.com/file/d/1zjbfzIbhLo3H16PK7hTl_R7sPNbj6Z7u/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <!-- Content on top -->
                <div class="relative z-10 w-full max-w-7xl mx-auto flex flex-col items-center justify-center bg-black/50 p-4 rounded-lg">
                    <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-7xl font-black text-cyan-300 tracking-tight">An Engineer's Dive into the Underwater World</h1>
                    <p class="mt-4 text-lg sm:text-xl md:text-2xl lg:text-3xl text-gray-300">A Technical Introduction to Freediving & Scuba Diving</p>
                </div>
            </div>

            <!-- Slide 2 -->
            <div class="slide w-full h-full flex-col justify-center items-center text-center hidden relative">
                <iframe src="https://drive.google.com/file/d/1yCxA9MZJ5j-gdQVCsSeKY-fO-unRg6P6/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <div class="relative z-10 w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-8">What is This All About?</h2>
                    <div class="grid md:grid-cols-2 gap-4 md:gap-8 text-left">
                        <div class="bg-gray-700/80 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-cyan-300 mb-2">Freediving</h3>
                            <p class="text-base md:text-lg">The practice of holding your breath when diving underwater without breathing equipment. It's a journey into your own mind and body's capabilities.</p>
                        </div>
                        <div class="bg-gray-700/80 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-cyan-300 mb-2">Scuba Diving</h3>
                            <p class="text-base md:text-lg">Using a Self-Contained Underwater Breathing Apparatus to breathe underwater for extended periods, allowing for prolonged exploration.</p>
                        </div>
                    </div>
                     <p class="mt-6 md:mt-12 text-lg md:text-xl text-gray-300">Our goal is to explore the science, skills, and mindset behind both.</p>
                </div>
            </div>
            
            <!-- Slide 3 -->
            <div class="slide w-full h-full flex flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1595182153598-a5a4a55734a2?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto flex flex-col items-center justify-center flex-grow bg-black/50 p-4 rounded-lg">
                     <div class="flex-shrink-0">
                        <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-2">Part 1: The Fundamental Science</h2>
                        <h3 class="text-xl sm:text-2xl md:text-3xl font-bold text-cyan-300 mb-2">The Overarching Force: Pressure</h3>
                        <p class="text-base md:text-lg max-w-3xl mx-auto mb-4">The deeper you go, the greater the pressure. For every 10 meters (33 ft) you descend, pressure increases by 1 Atmosphere (ATM).</p>
                     </div>
                     <div class="flex-grow w-full flex items-center justify-center min-h-0">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/e/eb/Pressure-under-water.svg" alt="Pressure vs Depth Diagram" class="object-contain max-w-full max-h-full rounded-lg bg-white/80 p-2">
                     </div>
                </div>
            </div>

            <!-- Slide 4 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1588421399342-e24416aa1b3b?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto text-center bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-4">Boyle's Law: The Squeeze</h2>
                    <button class="explain-btn" data-topic="Boyle's Law and diving">✨ Explain Simply</button>
                    <p class="text-base md:text-lg italic my-6">"At a fixed temperature, the volume of a gas is inversely proportional to the pressure."</p>
                    <table class="w-full max-w-2xl text-center bg-gray-700/80 rounded-lg mx-auto text-sm sm:text-base">
                        <thead class="bg-gray-600/80">
                            <tr>
                                <th class="p-2 sm:p-3 rounded-tl-lg">Depth</th>
                                <th class="p-2 sm:p-3">Pressure</th>
                                <th class="p-2 sm:p-3">Gas Volume</th>
                                <th class="p-2 sm:p-3 rounded-tr-lg">Lung Volume (6L)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-t border-gray-500"><td class="p-2 sm:p-3">0m</td><td class="p-2 sm:p-3">1 ATM</td><td class="p-2 sm:p-3">1x</td><td class="p-2 sm:p-3">6.0 L</td></tr>
                            <tr class="border-t border-gray-500 bg-gray-700/50"><td class="p-2 sm:p-3">10m</td><td class="p-2 sm:p-3">2 ATM</td><td class="p-2 sm:p-3">1/2x</td><td class="p-2 sm:p-3">3.0 L</td></tr>
                            <tr class="border-t border-gray-500"><td class="p-2 sm:p-3">20m</td><td class="p-2 sm:p-3">3 ATM</td><td class="p-2 sm:p-3">1/3x</td><td class="p-2 sm:p-3">2.0 L</td></tr>
                            <tr class="border-t border-gray-500 bg-gray-700/50"><td class="p-2 sm:p-3 rounded-bl-lg">30m</td><td class="p-2 sm:p-3">4 ATM</td><td class="p-2 sm:p-3">1/4x</td><td class="p-2 sm:p-3 rounded-br-lg">1.5 L</td></tr>
                        </tbody>
                    </table>
                    <p class="mt-6 text-base md:text-lg">This affects your Lungs, Ears, Sinuses, and Mask.</p>
                </div>
            </div>

            <!-- Slide 5 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1562446459-0c2839caf548?q=80&w=1974&auto=format&fit=crop');">
                <div class="w-full max-w-7xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-4 lg:mb-8 text-center">Archimedes' Principle: Buoyancy</h2>
                    <button class="explain-btn" data-topic="Archimedes' Principle and diving buoyancy">✨ Explain Simply</button>
                    <div class="flex flex-col md:flex-row items-center justify-center gap-8 lg:gap-12 mt-6">
                        <div class="text-left max-w-md lg:max-w-lg">
                            <p class="text-base md:text-lg italic mb-6">"An object immersed in water experiences a buoyant force equal to the weight of the water it displaces."</p>
                            <div class="space-y-4">
                               <div class="bg-gray-700/80 p-3 rounded-lg"><strong class="text-cyan-300">Positive Buoyancy (Surface):</strong> You float.</div>
                               <div class="bg-gray-700/80 p-3 rounded-lg"><strong class="text-cyan-300">Neutral Buoyancy (Mid-water):</strong> You hover.</div>
                               <div class="bg-gray-700/80 p-3 rounded-lg"><strong class="text-cyan-300">Negative Buoyancy (Deep):</strong> You sink. This video shows the "freefall" effect.</div>
                            </div>
                        </div>
                        <iframe class="w-full max-w-sm md:max-w-md lg:max-w-lg aspect-video rounded-lg" src="https://www.youtube.com/embed/MFUzWd5-dVo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                </div>
            </div>

            <!-- Slide 6 -->
            <div class="slide w-full h-full flex-col justify-center items-center text-center hidden relative">
                <iframe src="https://drive.google.com/file/d/13iUuV2JBD4FkPzByESrJ4jfCJr1-eqRL/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <div class="relative z-10 w-full max-w-6xl mx-auto text-center bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold mb-4">Part 2: A Deep Dive into Freediving</h2>
                    <h3 class="text-xl sm:text-2xl md:text-4xl font-bold text-cyan-300 mb-8">Urge to Breathe vs. Blackout</h3>
                    <div class="grid md:grid-cols-2 gap-4 md:gap-8 text-left max-w-3xl mx-auto">
                        <div class="bg-red-900/50 border border-red-500 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-red-300 mb-2">Urge to Breathe</h3>
                            <p><strong class="text-white">Cause:</strong> High CO₂ (Hypercapnia)</p>
                            <p><strong class="text-white">What it is:</strong> Your body's early warning system. It's your friend!</p>
                        </div>
                        <div class="bg-red-900/80 border border-red-400 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-red-300 mb-2">Blackout (L.O.C.)</h3>
                            <p><strong class="text-white">Cause:</strong> Low O₂ (Hypoxia)</p>
                            <p><strong class="text-white">What it is:</strong> A "circuit breaker" that happens without warning. The ultimate danger.</p>
                        </div>
                    </div>
                    <p class="mt-8 text-lg md:text-xl font-bold">Key Takeaway: The Urge to Breathe should happen LONG before a blackout is possible.</p>
                </div>
            </div>
            
            <!-- Slide 7 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1594704443830-50d78763b35a?q=80&w=1974&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold text-red-400 mb-8">The #1 Enemy: Hyperventilation</h2>
                    <p class="text-lg md:text-xl max-w-3xl mb-6 mx-auto">Breathing fast/deep before a dive is extremely dangerous. It flushes out CO₂, silencing your "urge to breathe" alarm without adding more oxygen.</p>
                    <div class="bg-gray-700/80 p-4 md:p-6 rounded-lg max-w-2xl mx-auto">
                        <p class="text-base md:text-lg">This can lead to your oxygen dropping to critical levels <strong class="text-red-400">before</strong> you get any signal to surface, resulting in a blackout with no warning.</p>
                    </div>
                    <p class="mt-6 text-base md:text-lg font-bold">If you feel dizzy or tingling, DO NOT DIVE.</p>
                </div>
            </div>

            <!-- Slide 8 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1559128010-4438919de1c3?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto text-center bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-6">The Superpower: Mammalian Dive Reflex</h2>
                    <button class="explain-btn" data-topic="the Mammalian Dive Reflex">✨ Explain Simply</button>
                    <p class="text-base md:text-lg max-w-3xl text-center my-6 mx-auto">An incredible, innate set of reflexes for breath-holding, triggered by face immersion in water and holding your breath.</p>
                    <div class="grid md:grid-cols-3 gap-4 text-center max-w-4xl mx-auto">
                        <div class="bg-gray-700/80 p-4 rounded-lg">
                            <h3 class="font-bold text-lg md:text-xl text-cyan-300">Bradycardia</h3>
                            <p class="text-sm md:text-base">Heart rate slows dramatically to conserve oxygen.</p>
                        </div>
                        <div class="bg-gray-700/80 p-4 rounded-lg">
                            <h3 class="font-bold text-lg md:text-xl text-cyan-300">Vasoconstriction</h3>
                            <p class="text-sm md:text-base">Blood shunts from extremities to vital organs.</p>
                        </div>
                        <div class="bg-gray-700/80 p-4 rounded-lg">
                            <h3 class="font-bold text-lg md:text-xl text-cyan-300">Spleen Effect</h3>
                            <p class="text-sm md:text-base">Spleen releases a reserve of oxygen-rich red blood cells.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 9 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1576965881023-21c6043810e3?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-7xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-6 w-full text-center">The Skill: Equalization</h2>
                    <button class="explain-btn" data-topic="ear equalization for diving, comparing Frenzel and Valsalva">✨ Explain Simply</button>
                    <div class="flex flex-col md:flex-row items-center justify-center gap-8 lg:gap-12 w-full mt-6">
                        <div class="text-left md:w-1/2 max-w-lg">
                            <p class="text-base md:text-lg mb-4">You must actively add air to your middle ear via the Eustachian Tube to counteract the "squeeze".</p>
                            <div class="mb-4">
                                <h3 class="font-bold text-lg md:text-xl text-red-400">Valsalva (Scuba Way)</h3>
                                <p class="text-sm md:text-base">Pinching nose and blowing from lungs. Inefficient for freediving.</p>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg md:text-xl text-green-400">Frenzel (Freediving Way)</h3>
                                <p class="text-sm md:text-base">Using the tongue as a piston to push air from the mouth/throat. More controlled, efficient, and relaxed.</p>
                            </div>
                        </div>
                        <div class="md:w-1/2 flex items-center justify-center">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/d/d2/Anatomy_of_the_Human_Ear.svg" alt="Anatomy of the Human Ear" class="rounded-lg shadow-lg bg-white p-2 w-full max-w-xs md:max-w-sm h-auto object-contain">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 10 -->
            <div class="slide w-full h-full flex-col justify-center items-center text-center hidden relative">
                <iframe src="https://drive.google.com/file/d/1DJ7b8WY3LGngVbhJBBcJufMFH6_ye0O0/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <div class="relative z-10 w-full max-w-6xl mx-auto text-center bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-6">The Process: A Safe Freedive</h2>
                    <ol class="list-decimal list-inside text-left text-base md:text-lg space-y-3 max-w-2xl mx-auto">
                        <li><strong class="text-cyan-300">Relaxation ("Breathe-up"):</strong> Calm, natural breathing.</li>
                        <li><strong class="text-cyan-300">One Full Breath:</strong> A single, deep, relaxed inhalation.</li>
                        <li><strong class="text-cyan-300">Duck Dive:</strong> Efficient, head-first entry.</li>
                        <li><strong class="text-cyan-300">The Dive:</strong> Relax, equalize early and often.</li>
                        <li><strong class="text-cyan-300">The Ascent:</strong> Stay streamlined, let buoyancy help.</li>
                        <li><strong class="text-cyan-300">Recovery Breathing:</strong> Sharp "Hook Breaths" to re-oxygenate.</li>
                        <li class="font-black text-xl md:text-2xl text-red-400 mt-4">NEVER DIVE ALONE. Your buddy is your lifeline.</li>
                    </ol>
                </div>
            </div>

            <!-- Slide 11 -->
            <div class="slide w-full h-full flex flex-col justify-center items-center text-center relative">
                <!-- Iframe as background -->
                <iframe src="https://drive.google.com/file/d/1Ash3Pj4LmrG6lCrrVcXMwJGgyDlVK5Yk/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <!-- Content on top -->
                <div class="relative z-10 w-full max-w-6xl mx-auto flex flex-col items-center justify-center bg-black/50 p-4 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold mb-2">Part 3: Submerging into Scuba</h2>
                    <h3 class="text-xl sm:text-2xl md:text-4xl font-bold text-cyan-300 mb-4">The Scuba System</h3>
                </div>
            </div>

            <!-- Slide 12 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1588421399342-e24416aa1b3b?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold text-red-400 mb-8">The #1 Rule of Scuba</h2>
                    <div class="bg-red-900/80 border-4 border-red-500 p-4 sm:p-8 rounded-lg max-w-3xl mx-auto">
                        <h3 class="text-2xl sm:text-4xl md:text-5xl font-black tracking-wider">NEVER, EVER HOLD YOUR BREATH.</h3>
                    </div>
                    <p class="mt-8 text-lg md:text-xl max-w-3xl mx-auto"><strong>Why? Reverse Boyle's Law.</strong> Air taken at depth expands on ascent. Holding your breath can cause a catastrophic Lung Overexpansion Injury.</p>
                </div>
            </div>

            <!-- Slide 13 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1577435494869-56209c117e94?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto text-center bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-cyan-300 mb-6">The Invisible Gas: Nitrogen</h2>
                    <button class="explain-btn" data-topic="Nitrogen Narcosis and Decompression Sickness in scuba diving">✨ Explain Simply</button>
                    <p class="text-base md:text-lg max-w-3xl text-center my-6 mx-auto">Air is ~79% Nitrogen. Under pressure, it causes two major issues for scuba divers:</p>
                    <div class="grid md:grid-cols-2 gap-4 md:gap-8 text-left max-w-4xl mx-auto">
                        <div class="bg-gray-700/80 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-cyan-300 mb-2">Nitrogen Narcosis</h3>
                            <p class="text-sm md:text-base">An intoxicating effect at depth ("feeling narc'd"). Impairs judgment. Solved by ascending.</p>
                        </div>
                        <div class="bg-gray-700/80 p-4 md:p-6 rounded-lg">
                            <h3 class="text-xl md:text-2xl font-bold text-cyan-300 mb-2">Decompression Sickness ("The Bends")</h3>
                            <p class="text-sm md:text-base">Nitrogen bubbles forming in tissues from ascending too fast. Prevented by slow ascents and safety stops.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 14 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center hidden" style="background-image: url('https://images.unsplash.com/photo-1595182153598-a5a4a_55734a2?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-7xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-xl sm:text-2xl md:text-4xl font-bold text-red-400 mb-6 text-center">The Main Risk: Hypoxia vs. Decompression Sickness</h2>
                    <div class="grid md:grid-cols-2 gap-4 md:gap-6 text-left max-w-5xl w-full mx-auto">
                        <div class="bg-gray-700/80 p-4 rounded-lg border-2 border-cyan-500">
                            <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-cyan-300 mb-3">Hypoxia (Freediving)</h3>
                            <ul class="list-disc list-inside space-y-2 text-sm sm:text-base">
                                <li><strong class="text-white">What:</strong> Critically low oxygen to the brain.</li>
                                <li><strong class="text-white">Cause:</strong> Holding your breath past your limit.</li>
                                <li><strong class="text-white">When:</strong> Can happen suddenly, often near the surface on ascent.</li>
                                <li><strong class="text-white">Prevention:</strong> Never hyperventilate, listen to your body, never dive alone.</li>
                            </ul>
                        </div>
                        <div class="bg-gray-700/80 p-4 rounded-lg border-2 border-orange-500">
                            <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-orange-400 mb-3">Decompression Sickness (Scuba)</h3>
                            <ul class="list-disc list-inside space-y-2 text-sm sm:text-base">
                                <li><strong class="text-white">What:</strong> Nitrogen bubbles forming in blood/tissues.</li>
                                <li><strong class="text-white">Cause:</strong> Ascending too quickly after absorbing nitrogen at depth.</li>
                                <li><strong class="text-white">When:</strong> Usually after the dive, can be delayed for hours.</li>
                                <li><strong class="text-white">Prevention:</strong> Slow ascents, safety stops, following dive computer limits.</li>
                            </ul>
                        </div>
                    </div>
                    <p class="mt-6 text-base md:text-lg text-center">Both are serious, but caused by completely different physiological processes.</p>
                </div>
            </div>
            
            <!-- Slide 15 -->
            <div class="slide w-full h-full flex-col justify-center items-center text-center hidden relative">
                <iframe src="https://drive.google.com/file/d/1cB4wdHpM4CZE7S6Y5ggUdLUphTJrZ3aV/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <div class="relative z-10 w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold mb-4 text-center">Part 4: The Comparison</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full max-w-4xl text-left bg-gray-700/80 rounded-lg text-xs sm:text-sm md:text-base mx-auto">
                            <thead class="bg-gray-600/80">
                                <tr>
                                    <th class="p-2 md:p-3 rounded-tl-lg">Feature</th>
                                    <th class="p-2 md:p-3 text-cyan-300">Freediving</th>
                                    <th class="p-2 md:p-3 text-cyan-300 rounded-tr-lg">Scuba Diving</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-t border-gray-500"><td class="p-1 md:p-2 font-bold">Breathing</td><td>One single breath</td><td>Continuous breathing</td></tr>
                                <tr class="border-t border-gray-500 bg-gray-700/50"><td class="p-1 md:p-2 font-bold">Goal</td><td>Internal challenge, silence</td><td>External exploration</td></tr>
                                <tr class="border-t border-gray-500"><td class="p-1 md:p-2 font-bold">Equipment</td><td>Minimalist</td><td>Life support system</td></tr>
                                <tr class="border-t border-gray-500 bg-gray-700/50"><td class="p-1 md:p-2 font-bold">Movement</td><td>Fluid, fast, silent</td><td>Slower, bubbles</td></tr>
                                <tr class="border-t border-gray-500"><td class="p-1 md:p-2 font-bold">Primary Risks</td><td class="text-red-400">Hypoxia / Blackout</td><td class="text-red-400">DCS / Lung Injury</td></tr>
                                <tr class="border-t border-gray-500 bg-gray-700/50"><td class="p-1 md:p-2 font-bold">Bottom Time</td><td>Short (1-4 mins)</td><td>Long (30-60+ mins)</td></tr>
                                <tr class="border-t border-gray-500"><td class="p-1 md:p-2 font-bold rounded-bl-lg">Mindset</td><td>Meditation, body awareness</td><td class="rounded-br-lg">Situational awareness</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Slide 16: NEW -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1526498460520-4c246339dccb?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold text-cyan-300 mb-4">✨ Dive Log Generator</h2>
                    <p class="text-base md:text-lg mb-4">Tell me about a dive and I'll write a log entry for you.</p>
                    <div class="grid sm:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="log-location" placeholder="Location (e.g., The Blue Hole)" class="bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        <input type="text" id="log-depth" placeholder="Depth (e.g., 30 meters)" class="bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        <input type="text" id="log-sightings" placeholder="Sightings (e.g., reef shark, turtles)" class="bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                    </div>
                    <button id="get-log-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-2 px-4 rounded-lg w-full sm:w-auto transition-transform duration-200 hover:scale-105">Generate Dive Log</button>
                    <div id="log-result" aria-live="polite" class="mt-4 text-left max-w-2xl bg-gray-700/50 p-4 rounded-lg h-48 overflow-y-auto mx-auto">
                        <!-- Gemini results will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Slide 17 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1518495973542-4542c06a5843?q=80&w=1974&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                    <h2 class="text-2xl sm:text-3xl md:text-5xl font-bold text-cyan-300 mb-4">✨ Dive Site Assistant</h2>
                    <p class="text-base md:text-lg mb-4">Enter a country or region to get dive site ideas!</p>
                    <div class="flex flex-col sm:flex-row items-center justify-center space-y-2 sm:space-y-0 sm:space-x-2">
                        <input type="text" id="location-input" placeholder="e.g., Egypt, Thailand, Mexico" class="bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 w-full sm:w-auto">
                        <button id="get-sites-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-2 px-4 rounded-lg w-full sm:w-auto transition-transform duration-200 hover:scale-105">Get Dive Site Ideas</button>
                    </div>
                    <div id="sites-result" aria-live="polite" class="mt-4 text-left max-w-2xl bg-gray-700/50 p-4 rounded-lg h-48 overflow-y-auto mx-auto">
                        <!-- Gemini results will be displayed here -->
                    </div>
                </div>
            </div>
            
            <!-- Slide 18 -->
            <div class="slide w-full h-full flex-col justify-start md:justify-center items-center text-center hidden" style="background-image: url('https://images.unsplash.com/photo-1551632811-561732d1e306?q=80&w=2070&auto=format&fit=crop');">
                <div class="w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                     <h1 class="text-2xl sm:text-3xl md:text-5xl font-bold text-cyan-300 mb-6">✨ Safety Quiz Generator</h1>
                     <button id="get-quiz-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-3 px-6 rounded-lg text-lg md:text-xl mb-6 transition-transform duration-200 hover:scale-105">Generate a Safety Quiz Question</button>
                     <div id="quiz-result" aria-live="polite" class="mt-4 text-left max-w-2xl bg-gray-700/50 p-4 md:p-6 rounded-lg min-h-[150px] mx-auto">
                         <!-- Gemini quiz question will be displayed here -->
                     </div>
                </div>
            </div>

            <!-- Slide 19 -->
            <div class="slide w-full h-full flex-col justify-center items-center text-center hidden relative">
                <iframe src="https://drive.google.com/file/d/1hJFZDRMBzPQWfdjsWVLs_VXtseh5YesG/preview?autoplay=1&loop=1" class="absolute top-0 left-0 w-full h-full z-0" allow="autoplay"></iframe>
                <div class="relative z-10 w-full max-w-6xl mx-auto bg-black/50 p-4 md:p-8 rounded-lg">
                     <h1 class="text-5xl sm:text-7xl md:text-8xl lg:text-9xl font-black text-cyan-300 tracking-tight">Q&A</h1>
                     <p class="mt-4 text-xl sm:text-2xl md:text-4xl text-gray-300">Any Questions?</p>
                </div>
            </div>
        </div>

        <!-- Navigation: Removed absolute positioning, now part of the flex column -->
        <div class="flex-shrink-0 h-16 bg-gray-900 flex items-center justify-between px-4 sm:px-8">
            <div class="text-base sm:text-lg font-bold">
                <span id="current-slide-num">1</span> / <span id="total-slides-num">19</span>
            </div>
            <div>
                <button id="prev-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-2 px-4 rounded-l-lg disabled:bg-gray-600 disabled:cursor-not-allowed transition-transform duration-200 hover:scale-105">
                    Prev
                </button>
                <button id="next-btn" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-2 px-4 rounded-r-lg disabled:bg-gray-600 disabled:cursor-not-allowed transition-transform duration-200 hover:scale-105">
                    Next
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal for "Explain Simply" feature -->
    <div id="explanation-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-2xl max-w-2xl w-full p-6 relative">
            <button id="close-modal-btn" class="absolute top-2 right-3 text-white text-3xl hover:text-cyan-300">&times;</button>
            <h3 id="modal-title" class="text-2xl font-bold text-cyan-300 mb-4"></h3>
            <div id="modal-content" class="text-gray-300 overflow-y-auto max-h-[60vh]"></div>
        </div>
    </div>


    <script>
        // --- Gemini API Call Function ---
        async function callGemini(prompt) {
            // IMPORTANT: Replace with your own restricted API key for use on a public site.
            const apiKey = "AIzaSyDB1Y7pERE0k92nOnVDoKYgingjDqN21dg"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{
                    role: "user",
                    parts: [{ text: prompt }]
                }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    if (response.status === 403) {
                         throw new Error(`API call failed: Forbidden (403). This often means the API key is invalid or lacks the necessary permissions. Please check your Google Cloud project settings.`);
                    }
                    throw new Error(`API call failed with status: ${response.status}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Unexpected API response structure:", result);
                    return "Sorry, the API returned an unexpected response. Please try again.";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return `An error occurred: ${error.message}`;
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Mobile Viewport Height Fix ---
            const setViewportHeight = () => {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            };
            window.addEventListener('resize', setViewportHeight);
            setViewportHeight();
            // --- End of Fix ---


            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const currentSlideNum = document.getElementById('current-slide-num');
            const totalSlidesNum = document.getElementById('total-slides-num');

            // Gemini Feature Elements
            const getSitesBtn = document.getElementById('get-sites-btn');
            const locationInput = document.getElementById('location-input');
            const sitesResult = document.getElementById('sites-result');
            const getQuizBtn = document.getElementById('get-quiz-btn');
            const quizResult = document.getElementById('quiz-result');
            const getLogBtn = document.getElementById('get-log-btn');
            const logResult = document.getElementById('log-result');
            const explainBtns = document.querySelectorAll('.explain-btn');
            const modal = document.getElementById('explanation-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');

            let currentSlideIndex = 0;
            const totalSlides = slides.length;

            totalSlidesNum.textContent = totalSlides;

            function showSlide(index) {
                slides.forEach(slide => {
                    slide.classList.add('hidden');
                    slide.classList.remove('flex');
                });

                if (slides[index]) {
                    slides[index].classList.remove('hidden');
                    slides[index].classList.add('flex');
                }
                
                currentSlideNum.textContent = index + 1;
                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === totalSlides - 1;
            }

            prevBtn.addEventListener('click', () => {
                if (currentSlideIndex > 0) {
                    currentSlideIndex--;
                    showSlide(currentSlideIndex);
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentSlideIndex < totalSlides - 1) {
                    currentSlideIndex++;
                    showSlide(currentSlideIndex);
                }
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                    closeModalBtn.click();
                }
                if (e.key === 'ArrowRight') nextBtn.click();
                if (e.key === 'ArrowLeft') prevBtn.click();
            });

            // --- Gemini Feature Logic ---

            getSitesBtn.addEventListener('click', async () => {
                const location = locationInput.value.trim();
                if (!location) {
                    sitesResult.innerHTML = "Please enter a location.";
                    return;
                }
                sitesResult.innerHTML = '<div class="flex justify-center items-center h-full"><div class="loader"></div></div>';
                const prompt = `You are a dive master creating a travel suggestion list. Based on the location "${location}", suggest 3 famous and exciting dive sites suitable for scuba or freediving. For each site, provide a short, one-paragraph description highlighting what makes it special. Format the output clearly with headings for each site.`;
                const response = await callGemini(prompt);
                sitesResult.innerHTML = response.replace(/\n/g, '<br>');
            });

            getQuizBtn.addEventListener('click', async () => {
                quizResult.innerHTML = '<div class="flex justify-center items-center h-full"><div class="loader"></div></div>';
                const prompt = `Based on the core safety principles of freediving (hypoxia, hyperventilation, buddy system) and scuba diving (never hold breath, nitrogen effects), generate one multiple-choice safety quiz question with four options (A, B, C, D) and indicate the correct answer. The question should be practical and relevant to a new diver.`;
                const response = await callGemini(prompt);
                quizResult.innerHTML = response.replace(/\n/g, '<br>');
            });

            getLogBtn.addEventListener('click', async () => {
                const location = document.getElementById('log-location').value.trim();
                const depth = document.getElementById('log-depth').value.trim();
                const sightings = document.getElementById('log-sightings').value.trim();

                if (!location || !depth || !sightings) {
                    logResult.innerHTML = "Please fill out all fields for the dive.";
                    return;
                }
                logResult.innerHTML = '<div class="flex justify-center items-center h-full"><div class="loader"></div></div>';
                const prompt = `Write a fun, narrative-style dive log entry for a dive in ${location} to a max depth of ${depth}. The main things I saw were ${sightings}. Make it sound like a real, personal dive log.`;
                const response = await callGemini(prompt);
                logResult.innerHTML = response.replace(/\n/g, '<br>');
            });

            explainBtns.forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const topic = e.target.dataset.topic;
                    modalTitle.textContent = `Explaining: ${topic}`;
                    modalContent.innerHTML = '<div class="flex justify-center items-center h-full"><div class="loader"></div></div>';
                    modal.classList.remove('hidden');

                    const prompt = `Explain ${topic} to me like I'm 10 years old. Use simple analogies and keep it short and easy to understand.`;
                    const response = await callGemini(prompt);
                    modalContent.innerHTML = response.replace(/\n/g, '<br>');
                });
            });

            closeModalBtn.addEventListener('click', () => {
                modal.classList.add('hidden');
                modalTitle.textContent = '';
                modalContent.innerHTML = '';
            });

            // Initial setup
            showSlide(currentSlideIndex);
        });
    </script>

</body>
</html>
